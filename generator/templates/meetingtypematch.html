{% extends "base.html" %}
{% from "_partials/status_badge.html" import status_badge %}
{% from "_partials/record_link.html" import record_link, simple_link %}

{% block title %}Meeting Type Match {{ entity.id }} - CG Review{% endblock %}

{% block content %}
<nav class="breadcrumb">
    <a href="{{ base_url }}/">Home</a> &raquo;
    <a href="{{ base_url }}/meetingtypematch/">Meeting Type Matches</a> &raquo;
    Match {{ entity.id }}
</nav>

<div class="entity-header">
    <h1>Meeting Type Match #{{ entity.id }}</h1>
    {% if entity.accepted is none %}
    <span class="status-badge unknown">Pending</span>
    {% elif entity.accepted %}
    <span class="status-badge valid">Accepted</span>
    {% else %}
    <span class="status-badge invalid">Rejected</span>
    {% endif %}
</div>

<section class="entity-details">
    <h2>Match Details</h2>

    <dl class="detail-list">
        <dt>Meeting Type</dt>
        <dd>{{ simple_link('meetingtype', entity.meetingtype_id, 'Meeting Type #' ~ entity.meetingtype_id) }}</dd>

        <dt>Authoritative Meeting Type</dt>
        <dd>{{ simple_link('authoritativemeetingtype', entity.authoritative_meetingtype_id, 'Auth. Type #' ~ entity.authoritative_meetingtype_id) }}</dd>

        <dt>Algorithm</dt>
        <dd><code>{{ entity.algorithm.value if entity.algorithm else entity.algorithm }}</code></dd>

        <dt>Confidence Score</dt>
        <dd><strong>{{ '%.2f'|format(entity.confidence_score) }}</strong></dd>

        <dt>Rank</dt>
        <dd>{{ entity.rank + 1 }}</dd>

        <dt>Accepted</dt>
        <dd>
            {% if entity.accepted is none %}
            <span class="pending">Pending</span>
            {% elif entity.accepted %}
            <span class="accepted-badge">Yes</span>
            {% else %}
            <span class="rejected-badge">No</span>
            {% endif %}
        </dd>

        <dt>Date</dt>
        <dd>{{ entity.date_added }}</dd>
    </dl>
</section>

{% if meetingtype %}
<section class="related-entities">
    <h2>Meeting Type</h2>
    <dl class="detail-list">
        <dt>Name</dt>
        <dd>{{ record_link(meetingtype, 'meetingtype', meetingtype.name) }}</dd>
        {% if meetingtype.category %}
        <dt>Category</dt>
        <dd>{{ meetingtype.category }}</dd>
        {% endif %}
    </dl>
</section>
{% endif %}

{% if auth_meetingtype %}
<section class="related-entities">
    <h2>Authoritative Meeting Type</h2>
    <dl class="detail-list">
        <dt>Name</dt>
        <dd><a href="{{ base_url }}/authoritativemeetingtype/{{ auth_meetingtype.id }}/">{{ auth_meetingtype.name }}</a></dd>
        <dt>Category</dt>
        <dd>{{ auth_meetingtype.category }}</dd>
        {% if auth_meetingtype.description %}
        <dt>Description</dt>
        <dd>{{ auth_meetingtype.description }}</dd>
        {% endif %}
    </dl>
</section>
{% endif %}

<section class="actions">
    <a href="{{ make_issue_url('meetingtypematch', entity.id, {
        'Meeting Type': entity.meetingtype_id|string,
        'Auth Type': entity.authoritative_meetingtype_id|string,
        'Score': entity.confidence_score|string,
        'Accepted': entity.accepted|string if entity.accepted is not none else 'Pending'
    }) }}" class="btn btn-report" target="_blank">
        Report Problem
    </a>
</section>
{% endblock %}
