{% extends "base.html" %}
{% from "_partials/status_badge.html" import status_badge %}
{% from "_partials/record_link.html" import record_link, simple_link %}
{% from "_partials/action_buttons.html" import action_buttons %}

{% block title %}Split Actor Match {{ entity.id }} - CG Review{% endblock %}

{% block content %}
<nav class="breadcrumb">
    <a href="{{ base_url }}/">Home</a> &raquo;
    <a href="{{ base_url }}/splitactormatch/">Split Actor Matches</a> &raquo;
    Match {{ entity.id }}
</nav>

<div class="entity-header">
    <h1>Split Actor Match #{{ entity.id }}</h1>
    {% if entity.accepted is none %}
    <span class="status-badge unknown">Pending</span>
    {% elif entity.accepted %}
    <span class="status-badge valid">Accepted</span>
    {% else %}
    <span class="status-badge invalid">Rejected</span>
    {% endif %}
</div>

<section class="entity-details">
    <h2>Match Details</h2>

    <dl class="detail-list">
        <dt>Split Actor</dt>
        <dd>{{ simple_link('splitactor', entity.split_actor_id, 'Split Actor #' ~ entity.split_actor_id) }}</dd>

        <dt>Authoritative Actor</dt>
        <dd>{{ simple_link('authoritativeactor', entity.authoritative_actor_id, 'Auth. Actor #' ~ entity.authoritative_actor_id) }}</dd>

        <dt>Algorithm</dt>
        <dd><code>{{ entity.algorithm.value if entity.algorithm else entity.algorithm }}</code></dd>

        <dt>Confidence Score</dt>
        <dd><strong>{{ '%.2f'|format(entity.confidence_score) }}</strong></dd>

        <dt>Rank</dt>
        <dd>{{ entity.rank + 1 }}</dd>

        <dt>Accepted</dt>
        <dd>
            {% if entity.accepted is none %}
            <span class="pending">Pending</span>
            {% elif entity.accepted %}
            <span class="accepted-badge">Yes</span>
            {% else %}
            <span class="rejected-badge">No</span>
            {% endif %}
        </dd>

        {% if entity.accepted_reason %}
        <dt>Reason</dt>
        <dd>{{ entity.accepted_reason }}</dd>
        {% endif %}

        <dt>Date</dt>
        <dd>{{ entity.date_added }}</dd>
    </dl>
</section>

{% if split_actor %}
<section class="related-entities">
    <h2>Split Actor</h2>
    <dl class="detail-list">
        <dt>Name</dt>
        <dd>{{ record_link(split_actor, 'splitactor', split_actor.name) }}</dd>
        {% if split_actor.actor_type %}
        <dt>Type</dt>
        <dd>{{ split_actor.actor_type }}</dd>
        {% endif %}
    </dl>
</section>
{% endif %}

{% if auth_actor %}
<section class="related-entities">
    <h2>Authoritative Actor</h2>
    <dl class="detail-list">
        <dt>Name</dt>
        <dd><a href="{{ base_url }}/authoritativeactor/{{ auth_actor.id }}/">{{ auth_actor.name }}</a></dd>
        <dt>Type</dt>
        <dd>{{ auth_actor.actor_type }}</dd>
        {% if auth_actor.description %}
        <dt>Description</dt>
        <dd>{{ auth_actor.description }}</dd>
        {% endif %}
    </dl>
</section>
{% endif %}

{{ action_buttons('splitactormatch', entity.id, {
    'Split Actor': entity.split_actor_id|string,
    'Auth Actor': entity.authoritative_actor_id|string,
    'Score': entity.confidence_score|string,
    'Accepted': entity.accepted|string if entity.accepted is not none else 'Pending'
}) }}
{% endblock %}
